# DSS 4.0 requirement 7.0: strong access control
### defined approach requirements
#### 7.0 restrict access to cardholder data by business on a need-to-know basis
* to ensure critical data can only be accessed by authorised personnel, systems and processes must be in place to limit access based on need to know and according to job responsibilities
* *“need to know”* is when access rights are granted to only the least amount of data and privileges needed to perform a job
#### 7.1 limit access to system components and cardholder data to only those individuals whose job requires such access
* examine written policy for access control and verify that the policy incorporates 7.1.1 through 7.1.4 as follows:
    * define access needs and privilege assignments for each role
    * restrict access to privileged user IDs to least privileges necessary to perform job responsibilities
    * assignaccess based on individual personnel’s job classification and function
    * document approval (electronically or in writing) by authorised parties for all access including listing of specific privileges approved
* the more people who have access to cardholder data, the more risk there is that a user’s account will be used maliciously
* limiting access to those with a legitimate business reason for the access helps an organisation prevent mishandling of cardholder data through inexperience or malice
##### 7.1.1 define access needs for each role
* include the following
    * system components and data resources that each role needs to access for their job function
    * level of privilege required (for example, user, administrator, etc.) for accessing resources
* in order to limit access to cardholder data to only those individuals who need such access, it is necessary to define access needs for each role (for example, system administrator, call centre personnel, store clerk etc); the systems/devices/data each role needs access to and the level of privilege each role needs to effectively perform assigned tasks are determined next
* once roles and corresponding access needs are defined individuals can be granted access accordingly
##### 7.1.2 restrict access to privileged user IDs to least privileges necessary to perform job responsibilities
* 7.1.2.a &rarr; interview personnel responsible for assigning access to verify that access to privileged user IDs are:
    * assigned only to roles that specifically require such privileged access
    * restricted to least privileges necessary to perform job responsibilities
* 7.1.2.b &rarr; select a sample of user IDs with privileged access and interview responsible management personnel to verify that privileges assigned are:
    * necessary for that individual’s job function
    * restricted to least privileges necessary to perform job responsibilities
* when assigning privileged IDs, it is important to assign individuals only the privileges they need to perform their job (the *“least privileges”*). for example, the database administrator or backup administrator should not be assigned the same privileges as the overall systems administrator
* assigning least privileges helps prevent users without sufficient knowledge about the application from incorrectly or accidentally changing application configuration or altering its security settings
* enforcing least privilege also helps to minimise the scope of damage if an unauthorised person gains access to a user ID
##### 7.1.3 assign access based on individual personnel’s job classification and function
* select a sample of user IDs and interview responsible management personnel to verify that privileges assigned are based on that individual’s job classification and function
* once needs are defined for user roles (per PCI DSS requirement 7.1.1), it is easy to grant individuals access according to their job classification and function by using the already-created roles
##### 7.1.4 require documented approval by authorised parties specifying required privileges
* select a sample of user IDs and compare with documented approvals to verify that:
    * documented approval exists for the assigned privileges
    * the approval was by authorised parties
    * that specified privileges match the roles assigned to the individual
* documented approval (for example, in writing or electronically) assures that those with access and privileges are known and authorised by management and that their access is necessary for their job function
#### 7.2 establish an access control system for systems components
* establish an access control system for systems components that restricts access based on a user’s *need-to-know*, and is set to `deny-all` unless specifically allowed
* this access control system must include the following: (See 7.2.1 through 7.2.3)
* examine system settings and vendor documentation to verify that an access control system is implemented as follows: (See 7.2.1 through 7.2.3)
* without a mechanism to restrict access based on user’s *need-to-know*, a user may unknowingly be granted access to cardholder data
* an access control system automates the process of restricting access and assigning privileges
* a default `deny-all` setting ensures no one is granted access until and unless a rule is established specifically granting such access
> *caveat*: some access control systems are set by default to `allow-all` thereby permitting access unless/until a rule is written to specifically deny it
##### 7.2.1 coverage of all system components
* confirm that access control systems are in place on all system components
##### 7.2.2 assignment of privileges to individuals based on job classification and function
* confirm that access control systems are configured to enforce privileges assigned to individuals based on job classification and function
##### 7.2.3 default `deny-all` setting
* confirm that the access control systems have a default `deny-all` setting
#### 7.3 ensure that security policies and operational procedures for restricting access to cardholder data are documented, in use and known to all affected parties
* examine documentation and interview personnel to verify that security policies and operational procedures for restricting access to cardholder data are:
    * documented
    * in use
    * known to all affected parties
* personnel need to be aware of and following security policies and operational procedures to ensure that access is controlled and based on need-to-know and least-privilege bases continually
### implications for APIs
* tight control of access rights
* track authorisation and authentication
* track who accesses what, when and where
* UIs are often relied upon for for security; this is improper
* have a review of API access control
* set up monitoring for RBAC changes