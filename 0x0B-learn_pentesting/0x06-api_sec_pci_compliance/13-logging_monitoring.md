# DSS 4.0 requirement 10.0: logging and monitoring
### defined approach requirements
* track and monitor all access to network resources and cardholder data
* log mechanisms and track user activity to preventing, detecting or minimising the impact of data security
* keep logs in all environments to allow extensive monitoring, warning and analysis when something goes wrong
* determining the cause of the attack is very difficult without logging the activity of the system
#### 10.1: apply audit trails to associate all access to system components with individual users
* it is essential to have a process or system that connects and associates user access to the system components that are accessed
* this system creates audit logs and provides the ability to track suspicious activity back to a specific user
    - audit trails must be effective and operational for system components
    - access to system components must depend on individual users
#### 10.2: apply automatic audit trails for all system components to reproduce events
* creating audit trails for suspicious activities alerts the system administrator
* send data to other monitoring mechanisms and provide a history trail for post-incident tracking
* log suspicious events to allow your organisation to identify and track potentially malicious activities
* automatic audit trails are required for all system components to reconfigure the following events:
    - all individual access to cardholder data
    - all transactions performed by any person with root or administrative privileges
    - access to all audit trails
    - invalid logical access attempts
    - use of identification and authentication mechanisms
    - starting audit logs
    - creating and deleting objects at the system level
##### 10.2.1: all individual access to cardholder data
* malicious individuals can obtain information about a user account with access to systems in the cardholder data medium (CDE) or create a new, unauthorised account to access the cardholder data
* a record of all individual access to cardholder data can determine which accounts may have been hacked or misused
##### 10.2.2: all transactions by root or any person with administrative privileges
* accounts with elevated privileges, such as the `administrator` or `root` account, may have a significant impact on the security or operational functionality of the system
* if the activities performed are not logged, any problems arising from an administrative error or privileges given to a specific action and individual cannot be monitored
##### 10.2.3: access to all audit log paths
* malicious users often try to change audit logs to hide their actions; access logs allow an organisation to track the inconsistencies or the possible tampering of records
* access to logs that define changes, additions and deletions may help track the steps taken by unauthorised personnel
##### 10.2.4: invalid logical access attempts
* malicious people often run multiple access attempts to reach targeted systems; more than one invalid login attempt may be an indication of an unauthorised user brute force attack or attempts to guess a password
##### 10.2.5: use and modification of identification and authentication mechanisms and all changes, additions or deletions in accounts with root or administrator privileges
* it is impossible to identify the accounts that could have been used at the time of the event without knowing who logged in. also, malicious users may try to change their authentication checks to bypass or emulate a valid account
##### 10.2.6: starting, stopping, or pausing audit logs
* it is common practice for malicious users who want to turn off or pause audit logs before carrying out illegal activities and avoid being spotted or spotted later
* starting, stopping or stopping audit logs may indicate that the log function is disabled or changed by the user to hide their actions
##### 10.2.7: creating and deleting system-level objects
* malware often creates or modifies system-level objects on the target system to control a specific function or process on the system
* it will be easier to determine whether such changes are allowed if system-level objects such as database tables or stored procedures are logged when they are created or deleted
#### 10.3 1-6
* record at least the following audit trail entries for all system components under each event
    - user ID
    - event type
    - date and time
    - indication of success or failure
    - source of the event
    - identity of the data, system component or resource that was affected
* when capturing this information for auditable events, it is possible to quickly identify a potential solution with sufficient detail to know who, when, where, where and how
#### 10.4 1-3
* synchronise all critical system clocks and times using time synchronisation technology
* synchronisation technology is used in multiple systems to synchronise the clocks; when clocks are not properly synchronised, it can be challenging to compare log files from different systems and create an exact sequence of events
> more info: [NTP Security][def]
* synchronisation and log sources show a consistent time for forensic analysis in the event of a violation
* for post-incident forensics teams, the accuracy and consistency of time in all systems and the time of each activity are critical in determining how systems are handled
* critical systems must have an accurate and consistent time
    - only designated central time servers should receive time signals from external sources and time signals from external sources should be based on [International Atomic Clock][def2] or [UTC][def3]
    - in case of more than one specified time server, the time servers must match and synchronise with each other to maintain the correct time
    - systems should receive time information only from designated central time servers
* time data should be preserved
    - access to time data should be limited only to personnel who need access to business time data
    - changes to time settings in critical systems should be logged, monitored and reviewed
* time settings should be taken from industry-accepted time sources
    - accept time updates for time servers from external sources accepted by the industry
    - said  updates can be encrypted with a symmetric key and access control lists can be created that specifies the IP addresses of client machines to be provided with time updates
#### 10.5: Secure audit trails cannot be altered
* malicious people entering the network try to edit or change audit logs to hide their activity
* if the audit logs are not adequately maintained, their accuracy and integrity cannot be guaranteed, therefore, audit logs can be rendered useless as an investigation tool after an investigation
##### 10.5.1 limit the display of audit trails only to those with business needs
* only people with a business need should be able to view audit trail files
##### 10.5.2 protect audit trail files from unauthorised changes
* adequate protection of audit logs includes robust access control and the use of physical or network separation to make logs challenging to find and replace
##### 10.5.3 back up audit trail files to a central log server or environment that is difficult to alter
* backing logs to a central log server or medium that is difficult to modify without losing time provides log protection if the system that creates logs is compromised
##### 10.5.4 Write logs for external technologies to a secure, central, internal log server or media device
* external-facing technology logs such as wireless devices, firewalls, DNS and mail servers will reduce the risk of loss or replacement as they are more secure on the internal network
* logs can be written directly to related resources or uploaded or copied securely from external systems to the internal system or media
##### 10.5.5 Use file integrity monitoring or change-detection software in logs to ensure that existing log data cannot be changed without generating an alert
* monitoring file integrity or change detection systems will check critical files for changes and report when those changes are made
* files that do not change regularly are monitored for file integrity monitoring purposes which means that there is a potential attack attempt when such files are changed
* newly added data should not cause an alert to prevent the generation of continuous alerts
#### 10.6: review logs and security events for all system components to identify abnormalities or suspicious activity
* many violations occur days or months before they are detected
* regular daily reviews by staff or automated methods can identify and proactively address unauthorised access to the cardholder’s data environment
> more info: [PCI SIEM requirements][def4]
* said  daily review does not have to be manual; using daily collection, segregation and alert tools can help streamline the process by identifying the daily events that need to be reviewed
##### 10.6.1: review logs of all system components that store, process or transmit CHD or SAD at least daily
* checking logs regularly daily will minimise the exposure time for a possible violation
* logs of critical system components are also required to identify potential problems
* determination of the safety incident may vary for each organisation; consideration should be given to the type, technology and function of the device
* organisations should also define *"normal"* traffic to help identify abnormal behaviour
* the following should be reviewed daily:
    * all security incidents
    * logs of all system components that store, process or transmit CHD or SAD
    * logs of all critical system components
    * logs of all servers and system components that perform security functions
##### 10.6.2: review the logs of all other system components according to organisation policies and risk management strategy as determined by the organisation’s annual risk assessment
* logs for all other system components should be reviewed periodically to identify symptoms of potential problems or attempts to access sensitive systems through less sensitive systems
* the annual business risk assessment should determine the frequency of the reviews
* depending on the organisation’s policies and risk management strategy, procedures for periodic review of logs of all other system components, either manually or automated, should be defined
##### 10.6.3: track exceptions and abnormalities detected during the review process
* if the exceptions and anomalies identified during the log review are not investigated, the organisation may not be aware of any unauthorised and potentially malicious activity occurring within its network
* said procedures needed to track the exceptions and abnormalities identified in the review process should be defined
#### 10.7: retain audit trail history for at least one year and have at least three months of data ready for analysis
* it usually takes some time to understand that an attack has reached its target or that the system has been exposed
> more info: [PCI DSS Log Retention Requirements][def5]
* keeping logs for at least one year allows a sufficient log history of researchers to determine the duration of a potential violation
* an entity can quickly identify and minimise the impact of a data breach by holding a quarterly journal
* storing logs in offline locations may prevent them from being available and longer time may be required to restore log data, analyse and identify affected systems or data
* the following items should be included in the security policies and procedures regarding audit logs:
    - audit logging retention policies
    - procedures for keeping audit logs for at least one year
    - procedures that make audit logs immediately accessible for at least three months online

#### 10.8: additional requirement for service providers only: apply a process for timely detection and reporting of faults in critical security control systems
* this requirement only applies when the assessed organisation is a service provider
* without formal processes to detect and alert critical security checks, failures cannot be seen for long periods; they can give attackers ample time to compromise systems and steal sensitive data from the cardholder data environment
* certain types of malfunctions may vary depending on the functionality of the device and the technology used
* typical faults are a system that ceases to perform its safety function or does not function as intended, example, a firewall that erases all of its rules or is offline
* critical security control systems can include:
    - firewalls
    - IDS / IPS
    - FIM
    - anti-virus
    - physical access controls
    - logical access controls
    - audit logging mechanisms
    - segmentation controls

##### 10.8.1 additional requirement only for service providers: respond to faults of critical security controls promptly
* this requirement only applies when the assessed organisation is a service provider
* attackers can use this time to add malware, take control of the system or steal data from the enterprise environment if critical security control error alerts do not respond quickly and effectively
* documented evidence should support the availability of procedures and procedures for responding to security failures
* also, employees should be aware of their responsibilities in the event of a malfunction; actions and responses to the error should be included in the documented evidence
* processes to respond to errors in security audits should include:
    - restoring security functions
    - determining and documenting the duration (date and time start/end) of the security failure
    - identify and document the causes of errors, including the root cause and write the necessary correction for the root cause
    - identify and resolve security issues that arise during a malfunction
    - to conduct a risk assessment to determine whether other actions are required as a result of a security failure
    - applying controls to prevent recurrence of the cause of the fault
    - continuing to monitor security controls
#### 10.9: ensure that security policies and operational procedures are documented, in use and known to all affected parties to monitor all access to network resources and cardholder data
* staff should be aware of and follow security policies and day-to-day operational procedures to monitor all access to network resources and cardholder data on an ongoing basis
> more info: [PCI DSS Quick Reference Guide][def6]

[def]: https://www.infosecinstitute.com/resources/general-security/network-time-protocol-ntp-threats-countermeasures/
[def2]: https://en.wikipedia.org/wiki/International_Atomic_Time
[def3]: https://en.wikipedia.org/wiki/Coordinated_Universal_Time
[def4]: https://pcidssguide.com/pci-siem-requirements/
[def5]: https://www.pcisecuritystandards.org/documents/Effective-Daily-Log-Monitoring-Guidance.pdf
[def6]: https://www.pcisecuritystandards.org/documents/PCIDSS_QRGv3_1.pdf