# path traversal
* path traversal vulnerability is anything that allows an attacker or user to access files and directories that are not intended to be served by the API or web server
* includes
    - direct file access inside or outside the web root
    -  access to things that were not in the web root at all, however, someone was able to get it through dynamic-file-includes or equivalent
* example
    - you develop a feature that allows an input to be used directly as a dynamic file-include of some sort or a file path that you are going to then return
    - say the feature is a cookie; recall, cookies can be easily crafted. there are a number of ways that we can perform traversals: a `../` to go to a parent directory, for example. you do that as many times as you need to in order to find the file that you are trying to get to. `/etc/passwd`, another example; if somebody can get a hold of it, then that is a very severe vulnerability
* possible paths to exploit
    - `/etc/passwd`
    - `.rsa`, `.git`
    - `c:/inetpub/logs/logfiles`
### causes
* among others...
    - server misconfiguration
    - little to no defensive coding
    - vulnerabilities in system specs
* example: malicious cookie and dynamic path source code

    ```text
        GET /vulnerable.php/1.0
        Cookie: 
        TEMPLATE=../../../../../../../../../../etc/passwd
    ```

    ```php
        <?php
            $template= "blue.php";
            if(is_set($_COOKIE['TEMPLATE']))
                $template= $_COOKIE['TEMPLATE'];
            include("/home/users/templates/", $template);
        ?>
    ```

    - anyone can create a template and inject it into the `template` variable
    - define explicitly what is allowed; do not anticipate and filter
    - example: strings that are used for path traversal

        ```text
            %2e%2e%2f is ../
            %2e%2e/ is ../
            ..%2f is ../
            ..%2c is ..\
            %252e%252e%255c is ..\
            ..%255c is ..\
        ```

    - such strings should never be allowed into the API at all; sanitise your input at the gateway/WAF level

### the problem(s)
1. input data validation
2. server config
    * directory listings, allowed `include` paths
3. dynamic paths in source code
4. loose spec ***"string"***
### the solutions(s)
1. scrub input data
    - specify what is allowed (enum/array/list etc)
    - do not filter what is not allowed; specify what is allowed
2. disable server directory listings
3. do not store anything sensitive at the web root
4. put the web root on a seperate drive from the system
5. remove variables from paths in the source code
6. when in doubt, throw an error