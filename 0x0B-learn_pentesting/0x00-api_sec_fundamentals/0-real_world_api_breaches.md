# anatomy of real-world API breaches
### 1. coinbase
* coinbase is a crypto trading platform
#### the vulnerability
* a vulnerability that allowed a user to sell crypto that they did not own
    - a missing logic validation check in the brokerage application
    - the app could not  confirm that the user submitting the transaction owned the account that initiated the transaction
* OWASP #1: broken object-level authorisation (BOLA)
    - user A is able to act on behalf of user B w/o the authorisation of user B
#### what the researcher did
* look at the traffic between the web interface and the backend
* reverse-engineered or sniffed the traffic between the application and the backend and identified the API calls
* identified four parameters in said call
    - the product ID &rarr; what he was trading
    - the order, in this case, a sell order
    - a source account
    - a target account
* researcher was able to manipulate said parameters to trade crypto on an account that did not belong to him
    - overwrote the source account to be an account that did not belong to him
    - this is not something you could even possibly do through the web interface, however,  in an API call, you can construct any type of request that you like
    - man, simply, changed the source account from user A to user B
### 2. USPS
* the *PS* stands for postal service
#### the vulnerability
* a user could set up an account and properly authenticate, however, once they were in, they could not only see their own records, but they could see the records of anyone with an address in the system
* OWASP #1: BOLA
    - user A is able to access the data/records of user B w/o the authorisation of user B
#### what the researcher did
* set up an account and properly authenticate
* once they were in, they could not only see their own records, but they could see the records of anyone with an address in the system
### 3. peloton
* peloton, the glorified treadmill company
#### the vulnerability
* had an API that had no authentication: literally wide open to the outside world
* API had full access to the entire database whether or not a user had marked their records as private
* first one is OWASP #1: BOLA
    - user A is able to access the data/records of user B w/o the authorisation of user B
* second one is OWASP #2: broken authentication (BA)
    - user A is able to access the data/records that s/he should not access
#### what the researcher did
* found the unauthenticated endpoint
* was able to access the data/records of users that had marked themselves as private
### 4. Venmo
* the Mpesa wannabe
* on the homepage, they would present real-time transactions or the most recent 10-20 transactions. they made sure to strip out identifiable information such as last names, descriptions etc
#### the vulnerability
* API that powered the homepage was not authenticated
    -  OWASP #2: BA
* said API returned not only anonymised data but also all the non-anonymised data: details of the sender and the recipient, transaction reason/narrative/description, dollar amounts etc
    - OWASP #1: BOLA
* server could be pinged up to 115,000 times a day
    - OWASP #4: unrestricted resource consumption (URC)
        - server has no controls to prevent unrestricted, uncontrolled access to data and resources
#### what the researcher did
* TLDR: a homepage that was created to show anonymised data was powered by an API that returned non-anonymised data. filtering happened at the UI, not the app level
* researcher looked at the homepage and decided to sniff the traffic between the homepage and the backend
* identified an API that was powering this feature; decided to try to call that API directly. it worked
* said API call did not require authentication
* also, it returned more info than requested
* server could be pinged up to 115,000 times a day per host (IP address)
    - distributed requests across two different IP addresses; over time increased it, the researcher harvested 200,000,000 transactions in full detail
### 5. instagram
* only fans v 0.0.0
#### the vulnerability
* account reset required a six-digit code that was provided by an API
    - brute-force: 1,000,000 combinations
* said API was consumed by two clients: the owner of the account (to type into the form provided) and the app itself (to verify the code)
* server has a limit on the number of guesses that an IP address can make: 200
#### what the researcher did
* demonstrated that one could rotate through 5,000 IPs in seconds; this enables the take-over of any account
    - 5,000 IPs each making 200 guesses = 1,000,000 guesses; simple brute force
### 6. bumble
* whatever the fuck this thing is
#### the vulnerability
* API allowed access to 95 million user accounts w/o authentication
    - OWASP #2: BA
* incremental IDs allowed one to scrape the entire DB
    - OWASP #1: BOLA
    - OWASP #4: URC
* API allowed one to calculate the exact location of any user using triangulation
    - OWASP #5: broken  function-level authorisation (BFLA) 
* API allowed access to premium features w/o authentication/authorisation
    - OWASP #5: BFLA
    - OWASP #1: BOLA
#### what the researcher did
* created three accounts and demostrated each vulnerability
### 7. t-mobile
* the US's equivalent of safaricom
#### the vulnerability
* a bad actor was obtaining data through a single API without authorisation
    - OWASP #1: BOLA
#### what the reasearcher did
> "a bad actor was obtaining data through a single Application Programming Interface (API)
> without authorisation..."
> "the preliminary result from our investigation indicates that the bad actor(s) obtained
> data from this API for approximately 37 million current postpaid and prepaid customer
> accounts..."
> T-Mobile US, Inc. Form 8-K, 19-Jan-2023
### 9. optus
* australia's equivalent of safaricom
#### the vulnerability
* API endpoint required no authentication to access
    - OWASP #1: BOLA
    - OWASP #2: BA
* API endpoint returned all the info contained in a user object; no filters/serialisation
    - OWASP #4: URC
#### what the researcher did
* attacker harvested 9.8 million user details and asked for one million dollars US as ransom
* data included DLs, medicare IDs, names, phone numbers and email addresses
### 10. experian
* a credit reporting agency
#### the vulnerability
* API could be called directly (not through the 3<sup>rd</sup>P website)
    - OWASP #2: BA
* API allowed anyone to look up the credit score of any user in the entire experian database using only an individual's name, address and date of birth
    - OWASP #1: BOLA
    - OWASP #3: BOPLA
    - OWASP #4: URC
* the date of birth field was not utilised; you could put any values you wanted - including all zeroes - and the experian database would respond with the credit records of any users that it had
    - OWASP #3: BOPLA
    - OWASP #4: URC
* experian let 3<sup>rd</sup> parties use its API w/o supervision
    - OWASP #9: improper inventory management (IMP)
#### what the researcher did
* sniffed the traffic  of a third party who used experian's API to allow user to know their credit score
* called the API directly (not through the website); was successful
    - no authentication required
* demonstrated the weaknesses of the API