# OWASP top 10
* OWASP &rarr; open web application security project
* 2023 OWASP API security top 10
    * API1 &rarr; broken object-level authorisation
    * API2 &rarr; broken authorisation
    * API3 &rarr; broken object property-level authorisation
    * API4 &rarr; unrestricted resource consumption
    * API5 &rarr; broken function-level authorisation
    * API6 &rarr; server-side request forgery
    * API7 &rarr; security misconfiguration
    * API8 &rarr; lack of protection from automated threats
    * API9 &rarr; improper assets management
    * API10 &rarr; unsafe consumption of APIs
### API1 : 2023 broken object-level authorisation
* aka BOLA
*  manipulate IDs and gain access to records that do not belong to you
#### example
* authenticate as user A but retrieve data as user B
#### risk exposure
* data loss
* disclosure of data
* manipulation of data
* reputational damage
#### prevention
* define data access policies
* implement data access controls
* enforce data access controls at application logic layer
* implement automated testing to  find BOLA flaws
* most common and damaging API vulnerability
### API2 : 2023 broken authentication
* endpoints have weak to no authentication mechanism/system
* 
#### examples
* weak passwords that are vulnerabile to
    - credential stuffing
    - brute force attacks
    - 
* no CAPTCHAs or rate limiting
* no lock-outs of accounts
* credential info is put on URLs (for example, as query parameters)
* changing passwords w/o authentication, authorisation or verification
* failing to validate tokens
* failing to store paswords properly
#### risk exposure
* attackers gain control of user accounts
* theft of data
* unauthorised transactions
#### prevention
* define authentication standards
* implement said authentication standards on the application logic level
* enforce said authentication standards
* follow best practices
### API3 : 2023 broken object property-level authorisation
* endpoints are exploited by reading and/or writing values of objects
* BOPLA is a merger of two previous OWASPs
    - mass assignment &rarr; attacker can update object elements e.g. account types
    - excessive data exposure &rarr; API returns too much information (e.g. return the whole user object instead of the user's name)
#### examples
* attacker/user can set account type to `premium` from `free`
* user `search` endpoint returns unnecessary information e.g. name, email, password etc
#### risk exposure
* protected user data may be revealed
#### prevention
* design an authorisation strategy/standards
* implement said strategy/standards at the app logic level
* enforce said strategy/standards
    - return only the data required for the use case
    - ensure users can access and/or modify only legitimate, permitted fields
### API4 : 2023 unrestricted resource consumption
* formerly `lack of resources and rate limiting`
* inadequate traffic control can allow
    - mass data retrieval
    - risk of operation interruption
#### examples
* missing or inadequate rate controls (set too high)
    - a user queries 1000 times when it only needs access once or twice
* lack of
    - execution timeouts
    - max allocatable memory
    - max number of file descriptors
    - max file upload size
* excessive ops in a single request
* excessive records returned in a single request
#### risk exposure
* DoS
* data harvesting
#### prevention
* define traffic control standards
* implement said traffic control standards on the application logic level
* enforce said traffic control standards
* follow best practices
### API5 : 2023 broken function-level authorisation
* abuse of API functionality to improperly modify objects (CRUD)
    - modify resources of another user
* often involves passive methods (`GET`) with active ones (`PUT`, `DELETE`)
#### examples
* modify paramaters
    - e.g. `PUT / HTTP ... ?role=admin` (add `admin` role to a regular user)
* delete an invoice
    - e.g. `DELETE / HTTP ... ?id=xXyY12bB` (delete invoice xXyY12bB)
* set account balance to zero
    - e.g. `PATCH / HTTP ... ?id=xXyY12b&balance=0` (set account id xXyY12bB's balance to zero)
#### risk exposure
* possible privilege  escalation
* modification of account details
* attackers may access unauthorised endpoints and functionality
* possible access to administrative endpoints/functions
#### prevention
* identify functions that expose high sensitivity capability and develop controls to limit access
* implement continuous release testing to ensure proper behaviour
### API6 : 2023 server-side request forgery
* 
#### examples
* 
#### risk exposure
* 
#### prevention
* 
### API7 : 2023 security misconfiguration
* 
#### examples
* 
#### risk exposure
* 
#### prevention
* 
### API8 : 2023 lack of protection from automated threats
* 
#### examples
* 
#### risk exposure
* 
#### prevention
* 
### API9 : 2023 improper assets management
* 
#### examples
* 
#### risk exposure
* 
#### prevention
* 
### API10 : 2023 unsafe consumption of APIs
* 
#### examples
* 
#### risk exposure
* 
#### prevention
* 