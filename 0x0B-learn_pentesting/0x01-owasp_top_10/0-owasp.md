# OWASP
* Open Web Application Security Project
* a non-profit foundation that is created to help improve application security
* OWASP API security Top 10 is a list of the most critical security risks for APIs
### why release a top 10 list?
##### 1. rapid ride of APIs
* APIs power the flow of the world's most valuable resource, data
* a business no longer needs to specialise in all aspects of creating software, instead, they can use the features of software shared by other companies
* historically, the issue with doing this was the disconnected nature of different programming languages
    - web application programming interfaces (APIs) allow a common method to consume or provide data across the internet
* since the widespread adoption of web APIs, organisations can leverage the functionality of other applications
    - instead of having to develop custom software for maps, GPS, payment processing, authentication, communication and much more, developers can leverage APIs to use the functionality of other applications that specialise in that given area
* APIs are a major business enabler which explains the global rapid adoption 
##### 2. gaps in security
* the tools and techniques of the past were not effective at detecting API-related vulnerabilities
* the tools and techniques that were used for enterprise vulnerability management programs, web application scanners and traditional network security monitoring tools were not designed to handle the unique challenges posed by APIs
* as a result, many organisations are not adequately prepared to defend against API attacks which leaves them vulnerable to data breaches
##### 3. new leading attack vector
* security is an afterthought when it comes to the rapid adoption of new technologies
* APIs are no different; the rapid adoption of APIs means a new attack vector that exposes data, application functionality etc
* public, internet-facing APIs often bypass all the security measures that had grown with businesses over the past decade
    - an attacker no longer needs to go through the classic [MITRE cyber kill chain][def] (bypass the firewall, gain entry to the network, pivot to a system containing data and exfiltrate that data)
    - instead, an attacker can use an insecure API and have direct access to sensitive data
### how is the top 10 list compiled?
> &quot; internal research based on publicly available data (e.g. bug bounty platforms, news) &quot;
> > - Paulo Silva, OWASP API Sec project leader

* this dataset is not as ideal as data compiled directly from testing hundreds of thousands of endpoints across the internet, however, it represents a sample of real-world API weaknesses
* potential issues with applying this data include:
    - bug bounty programmes incentivise certain types of findings over others
    - bug bounty programmes attract participant that represents a small sample of the APIs in the wild
    - newsworthy incidents often leave security researchers without specific technical details
    - newsworthy incidents do not include all of the breaches and security incidents that are not reported or publicised

### mapping to external resources
* OWASP API Security risks are associated with references to external sources. said sources include common weakness enumeration (CWE), other OWASP projects, national institute of standards and technology (NIST) and government communications headquarters (GCHQ)
* most of the references are from CWEs. CWEs are a list of common software and hardware vulnerabilities developed by the community and hosted by MITRE
* each CWE is identified by a unique identifier or CWE-ID. this identifier is used to refer to a specific vulnerability

    |OWSP top 10|external reference|
    |:---|:---|
    |API1:2023 broken object-level authorisation|[CWE-285: improper authorisation][def2], [CWE-639: authorisation bypass through user-controlled key][def3]|
    |API2:2023 broken authentication|[CWE-204: Observable Response Discrepancy][def4], [CWE-307: Improper Restriction of Excessive Authentication Attempts][def5]|
    |API3:2023 broken object property-level authorisation|[CWE-213: Exposure of Sensitive Information Due to Incompatible Policies][def6], [CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes][def7], [API3:2019 Excessive Data Exposure - OWASP API Security Top 10 2019][def8], [API6:2019 - Mass Assignment - OWASP API Security Top 10 2019][def9]|
    |API4:2023 unrestricted resource consumption|[CWE-770: Allocation of Resources Without Limits or Throttling][def10], [CWE-400: Uncontrolled Resource Consumption][def11], [CWE-799: Improper Control of Interaction Frequency][def12], [NIST Security Strategies for Microservices-based Application Systems][def13]|
    |API5:2023 broken function-level authorisation|[CWE-285: Improper Authorisation][def14], [OWASP Top 10 2013: A7: Missing Function Level Access Control][def15], [OWASP Guidance: Forced Browsing][def16], [OWASP Guidance: Access Control][def17]|
    |API6:2023 unrestricted access to sensitive business flows|[API10:2019 Insufficient Logging & Monitoring][def18], [OWASP Automated Threats to Web Applications][def19]|
    |API7:2023 server-side request forgery|[CWE-918: Server-Side Request Forgery (SSRF)][def20], [URL confusion vulnerabilities in the wild: Exploring parser inconsistencies, Snyk][def21], [Server Side Request Forgery][def22], [Server-Side Request Forgery Prevention Cheat Sheet][def23]|
    |API8:2023 security misconfiguration|[CWE-2: Environmental Security Flaws][def24], [CWE-16: Configuration][def25], [CWE-209: Generation of Error Message Containing Sensitive Information][def26], [CWE-319: Cleartext Transmission of Sensitive Information][def27], [CWE-388: Error Handling][def28], [CWE-444: Inconsistent Interpretation of HTTP Requests ('HTTP Request/Response Smuggling')][def29], [CWE-942: Permissive Cross-domain Policy with Untrusted Domains][def30], [NIST Guide to General Server Security][def31], [Let's Encrypt: a free, automated, and open Certificate Authority][def32], [OWASP Secure Headers Project][def33], [Configuration and Deployment Management Testing - Web Security Testing Guide][def34], [Testing for Error Handling - Web Security][def35]|
    |API9:2023 improper inventory management|[CWE-1059: Incomplete Documentation][def36]|
    |API10:2023 unsafe consumption of APIs|[CWE-285: Improper Authorisation][def38], [CWE-639: Authorisation Bypass Through User-Controlled Key][def37]|

### risk rating
* [OWASP Risk Rating Framework][def39]
    - [OWASP API Security Top 10 2019 PDF][def40]

        |threat agents|exploitability|weakness prevalence|weakness detectability|technical impact|business impact|
        |:---:|:---:|:---:|:---:|:---:|:---:|
        |API-specific|easy: 3|widespread: 3|easy : 3|severe: 3|business-specific|
        |API-specific|average: 2|common: 2|average: 2|moderate: 2|business-specific|
        |API-specific|difficult: 1|difficult: 1|difficult: 1|minor: 1|business-specific|

* classic equation for risk is $likelihood * impact$
    - that is: $risk \propto likelihood * impact$
    - higher likelihood of occurrence of risk means higher risk of attack and vv
    - higher impact on occurrence of risk means higher risk to business ops and vv
* API Security project team has left the impact as a relative value to be determined by the business
    - the project team includes a note along with these scores that the likelihood of these scores is not taken into account (API Security Risks)
    - what we are left with are values that represent overall exploitability (complexity/exploitability, weakness prevalence, weakness detectability and technical impact)
* the overall score does not equate to a risk score because significant factors such as business impact and likelihood are not accounted for


[def]: https://www.sans.org/blog/cyber-kill-chain-mitre-attack-purple-team/
[def2]: https://cwe.mitre.org/data/definitions/285.html
[def3]: https://cwe.mitre.org/data/definitions/639.html
[def4]: https://cwe.mitre.org/data/definitions/204.html
[def5]: https://cwe.mitre.org/data/definitions/307.html
[def6]: https://cwe.mitre.org/data/definitions/213.html
[def7]: https://cwe.mitre.org/data/definitions/915.html
[def8]: https://github.com/OWASP/API-Security/blob/master/2019/en/src/0xa3-excessive-data-exposure.md
[def9]: https://github.com/OWASP/API-Security/blob/master/2019/en/src/0xa6-mass-assignment.md
[def10]: https://cwe.mitre.org/data/definitions/770.html
[def11]: https://cwe.mitre.org/data/definitions/400.html
[def12]: https://cwe.mitre.org/data/definitions/799.html
[def13]: https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-204.pdf
[def14]: https://cwe.mitre.org/data/definitions/285.html
[def15]: https://github.com/OWASP/Top10/raw/master/2013/OWASP%20Top%2010%20-%202013.pdf
[def16]: https://owasp.org/www-community/attacks/Forced_browsing
[def17]: https://owasp.org/www-community/Access_Control
[def18]: https://owasp.org/API-Security/editions/2019/en/0xaa-insufficient-logging-monitoring/
[def19]: https://owasp.org/www-project-automated-threats-to-web-applications/
[def20]: https://cwe.mitre.org/data/definitions/918.html
[def21]: https://snyk.io/blog/url-confusion-vulnerabilities/
[def22]: https://owasp.org/www-community/attacks/Server_Side_Request_Forgery
[def23]: https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html
[def24]: https://cwe.mitre.org/data/definitions/2.html
[def25]: https://cwe.mitre.org/data/definitions/16.html
[def26]: https://cwe.mitre.org/data/definitions/209.html
[def27]: https://cwe.mitre.org/data/definitions/319.html
[def28]: https://cwe.mitre.org/data/definitions/388.html
[def29]: https://cwe.mitre.org/data/definitions/444.html
[def30]: https://cwe.mitre.org/data/definitions/942.html
[def31]: https://csrc.nist.gov/publications/detail/sp/800-123/final
[def32]: https://letsencrypt.org/
[def33]: https://owasp.org/www-project-secure-headers/
[def34]: https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/README
[def35]: https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/README
[def36]: https://cwe.mitre.org/data/definitions/1059.html
[def37]: https://cwe.mitre.org/data/definitions/639.html
[def38]: https://cwe.mitre.org/data/definitions/285.html
[def39]: https://owasp.org/www-project-risk-assessment-framework/
[def40]: https://owasp.org/www-project-risk-assessment-framework/