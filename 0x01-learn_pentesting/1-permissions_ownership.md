# File and directory permissions

* idea is to see how permissions and ownership in files and dirs work
* everything, in Linux, is a file. repeat: everything, in Linux, is a file 
* run the folowing command

    ~~~bash
    ls -la
    ~~~

* expect output to look like this

    ~~~text
    drwxrw-rw- 3 username usergroup 4096 May 12 03:26 .
    drwxrw-rw- 36 username usergroup 4096 May 12 00:26 ..
    drwxrw-rw- 2 username usergroup 4096 Mar 02 03:18 dirname
    -rwxrw-r-- 1 username usergroup 4096 May 12 03:20 filename.ext
    ... 
    ~~~

* here is how to read the output
    * `drwxrw-rw-` --> file type and permissions (this is what we are interested in)
    * `3` --> number of links to the file
    * `username` --> user owner of file
    * `usergroup`  --> group owner of file
    * `4096` --> size of file in bytes
    * `May 12 03:26` --> date last modified
    * `.` --> name of file (single dot means current directory, double dot means parent of current directory)
* there are two formats of looking at file permissions
    * symbolic format. the _rwx_ way of representing permissions
        * `r` means read, that is, view the contents of a file
        * `w` means write, that is, edit the contents of a file
        * `x` means execute, that is, run a file
        * take `-rwxrw-r--`, for example
            * `-` says it is a regular file, not a directory
                * `d` means directory
                * `l` means symbolic link
                * etc
            * `rwxrw-rw-` are the permissions of this file. there are three sections, actually
                * `rwx` --> user owner permissions. the user owner is the one who creates a file. here, the user owner has read, write and execute permissions
                * `rw-` --> user group permissions. the user group is the group to which a user owner belongs. here the user group has read and write permissions but not execute (notice the hyphen after _w_)
                * `r--` --> _other_ or _world_ permissions. these are permissions granted to all other users. here, all other users can only read the file (the double hyphen after _r_)
    * octal/binary format. the _777_ way of representing permissions
        * use the octal number system to represent permissions
            * 4 --> `r`, 2 --> `w` and 1 --> `x`; 0 if permission not set
                * permission can be set (1) or unset (0)
                * there are three permissions: r, w and x
                * possible combinations: 000, 001, 010, 011, 100, 101, 110, 111
                * notice how these combinations resemble bits
                * using the big endian approach (the rightmost bit is least significant), there are three bits; in other words, 2^2, 2^1 and 2^0 positions
                * these positions correspond with the positions of `rwx`, hence, the 4, 2 and 1
            * add the permissions for each section
            * use the combination of sums to represent permissions
            * example: `rwxrw-rw-`
                * `rwx` --> 4 + 2 + 1 = 7
                * `rw-` --> 4 + 2 + 0 = 6
                * `r--` --> 4 + 0 + 0 = 4
                * `rwxrw-rw-` in octal format is `764`
* use `chmod` to set (or change) permissions
    * `ch`ange `mod`e. check out the [man page][def]
    * usage: `chmod OPTIONS FILENAME`
    * the following code snippets have the same effect

        ~~~bash
        chmod g+x filename.ext
        ~~~

        ~~~bash
        chmod g=rwx filename.ext
        ~~~

        ~~~bash
        chmod 774 filename.ext
        ~~~

    the permissions of `filename.ext` change from `rwxrw-r--` (or 764) to `rwxrwxr--` (or 774)
    * `u` --> user, `g` --> group, `o` --> others and `a` --> all
    * `+` --> add permission(s) and `-` --> remove permission(s)
    * `=` --> assign (add and/or remove) permission(s)
*  use the flag `-R` to change permissions _recursively_
    * `chmod -R 744 dirname` sets the permissions of `dirname` and all files inside it to `744` or `rwxr--r--`

### permissions for directories 
* there are special rules for directories
    * `r` --> when set, it allows a user to list the files within the directory
    * `w` --> when set, it allows a user to create, rename or delete files within the directory and modify the directory's attributes
    * `x` --> when set, it allows the a user to enter the directory and  access its contents

### other bits/permissions
* `l` --> symbolic link; a file that points to another one
* `t` --> sticky bit. files and directories within a directory may only be deleted or renamed by their owner (or root). here, the execute bit is set for _others_
* `T` --> same as `t`; files and directories within a directory may only be deleted or renamed by their owner (or root). here, the execute bit is not set for _others_
* this is not all; complete permissions, in octal format, look like this: 0744, 2777, 1765 etc the leading bit (0 in 0744, 2 in 2777 and  1 in 1765) will be discussed later

[def]: https://man7.org/linux/man-pages/man2/chmod.2.html