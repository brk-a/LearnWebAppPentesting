import React from 'react'
import {BrowserRouter as Router, useLocation} from "react-router-dom"

const useQuery = () => {
    const {search} = useLocation()
    return React.useMemo(() => new URLSearchParams(search), [search])
}

const QueryParamsDemo = () => {
    let query = useQuery()

    /**validateURL is the fix to the vulnerability */
    const validateURL = (url) => {
        const useSuppliedUrl = new URL(url)

        if(useSuppliedUrl.protocol==='https:'){
            return url
        }

        return "/"
    }

    return(
        <div>
            <h2>Return Home</h2>
            <a href={validateURL(query.get("redirect"))}>
                Click to go home
            </a>
        </div>
    )
}
const Root = () => {
  return (
    <Router>< QueryParamsDemo /></Router>
  )
}

export default Root