# host header injection

#### what the code does
* generates a URL that allows a user to change his(er) password
* listens for a `POST` request at the endpoint `/generate-pwd-reset-url`
* looks for the customer in the db using customer's email
* generates a password reset token unique to the customer's id
* generates password reset URL and returns it in the response body

#### what TF is host header injection?
* attacks that involve injecting a payload directly into the host header
* HTTP host header attacks exploit vulnerable websites that handle the value of the host header in an unsafe way
* if the server implicitly trusts the host header and fails to validate or escape it properly, an attacker may be able to use this input to inject harmful payloads that manipulate server-side behaviour

#### the vulnerability
* host header injection

#### why it is vulnerable
* the `req.header('host')` bit; an attacker can pass a malicious link into it
* web applications, off-the-shelf especially, typically do not know what domain they are deployed on unless it is manually specified in a configuration file during setup. to know the current domain, they may retrieve the domain from the host header. example: generate an absolute URL included in an email

    ```html
        <a href="https://_SERVER['HOST']/support">Contact support</a>
    ```

* header value may be used in a variety of interactions between different systems of the website's infrastructure
* header is, in fact, user-controllable; this practice can lead to a number of issues. if the input is not properly escaped or validated, the host header is a potential vector for exploiting a range of other vulnerabilities notably:
    * web cache poisoning
    * business logic flaws in specific functionality
    * routing-based SSRF
    * classic server-side vulnerabilities such as SQL injection

#### what now?
* fail to use `req.header('host')` directly
* store the value of the host URL in an `.env` file and use `process` to retrieve it
