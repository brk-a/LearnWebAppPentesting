# mass assignment attack

#### what the code does
* listens for a `POST` request at the `/signup` endpoint
* checks whether username provided by a user at `req.body.username` exists in the db
    * if yes: check whether the db returned a user
        * if yes: do nothing
        * if no: create/insert user in db and return code `200`
    * if no: either
        * return code `500` and an error message or
        * return code `409`

#### what TF is a mass assignment attack?
* allows attackers to create new parameters that the developer never intended. said params create or overwrite new variables or objects in the code
* more info [here][def]

#### the vulnerability
* mass assignment attack

#### why it is vulnerable
* using `req.body.username` directly when querying the db
    * find _username_
    * insert a user to db
* we can set `req.body` to be (assuming it follows the db schema and that the user is not an admin):

    ```js
        {
            username: "goat-matata",
            password: "O+gkpVO0KtpKvrvVe/67eA==",
            email: "goatmatata@memail.co.ke",
            isAdmin: true,
        }
    ```

* we do not have control over `req.body` when inserting into db, therefore, anyone who know how to can pass whatever it is they wish to `req.body`

#### what now?
* fail to use `req.body` directly
* use a new object that gets only what is needed from `req.body`
* set `isAdmin` ans such other sensitive data internally

[def]: https://cheatsheetseries.owasp.org/cheatsheets/Mass_Assignment_Cheat_Sheet.html