app.get("/api/data", async (res, req) => {
    /**allowedURLs is the fix to the vulnerability */
    const allowedURLs = [
        "https://www.example.com/api/data?url=https://internal.myapp.com/stock-items.json",
    ]

    const url = req.query.url
    try {

        /**check if url is not in allowedURLs. return 400 if yes */
        if(!allowedURLs.includes(url)){
            return res.status(400).json({error: "Bad URL"})
        }
        
       const response = await fetch(url)
       const data = await response.json()
       res.status(200).json({data: data})
    } catch (error) {
        console.log(error)
        res.status(500).json({error: error.message})
    }
})