# SSRF: vulnerable query params

#### what the code does
* listens for `GET` requests on the enpdpoint `/api/data`

        
        https://www.example.com/api/data?url=your-url-here
        

* uses query params ( the `url` variable)
* `fetch`es data from said url, returns a response, `json`ifys said response
returns json to user and responds with status `200` if everything went alright,
else, `500`

#### what TF is SSRF?
* server-side request forgery
* an attacker tricks a server to do the attacker's dirty work
* attacker gets access to _super user_ permissions in order to perform said trickery
* 

#### the vulnerability
* SSRF

#### why it is vulnerable
* consider the following (assume that the former is public and the latter is not)

        
        https://www.example.com/api/data?url=https://internal.myapp.com/stock-items.json
        https://www.example.com/api/data?url=https://internal.myapp.com/passwords.json
        

* `url`, in this case, is a url: `https://internal.myapp.com/stock-items.json`. the server, being _the server_, has permission to access the files `stock-items.json` and `passwords.json`; an attacker and/or random web scraper does not have permission to access `passwords.json`. however, they can use the servers permissions to access said files

#### what now?
* QED; create a whitelist (or blacklist, if you can; it is easier/more efficient to create a whitelist)
* create a variable, `allowedURLs`
* said var is an array of allowed urls
* in the listener, compare the value of `url` to the contents of `allowedURLs`
    *  if `url` in `allowedURLs`, fetch etc, else, return status `400`