app.post("/generate-pwd-reset-url", async (req, res) => {
    //assume customer exists
    const customer = await customerdb.findOne(req.body.email)
    const resetToken = await genPwdResetToken(customer._id)
    const resetPwdUrl = `${req.header('host')}/passwordReset?token=${resetToken}&id=${customer.id}`

    return res.json({resetPwdUrl: resetPwdUrl})
})

/**using environment vars fixes the vuln */
app.post("/generate-pwd-reset-url", async (req, res) => {
    //assume customer exists
    const customer = await customerdb.findOne(req.body.email)
    const resetToken = await genPwdResetToken(customer._id)
    const resetPwdUrl = `${process.env.HOST_URL}/passwordReset?token=${resetToken}&id=${customer.id}`

    return res.json({resetPwdUrl: resetPwdUrl})
})