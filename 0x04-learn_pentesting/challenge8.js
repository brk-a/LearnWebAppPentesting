const jwt = require('jsonwebtoken')

//secret key for signing JWT
const secret = "my-secret-key" //bad

/**using `process.env` fixes the vuln */
const better_secret = process.env.JWT_TOKEN // better

app.post("/login", (req, res) => {
    // assume auth happens successfully & the following user is
    //returned from db
    const user = {id: 123, name: "Goat Matata"}

    //sign JWT with user ID and secret key
    const token = jwt.sign(user, secret)

    //send JWT to client
    res.json({token})
})