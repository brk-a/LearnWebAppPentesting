# XSS (reflected, stored & DOM)

* idea is to see how reflected, stored and DOM XSS works
* environment: Kali Linux
* punching bags: WebGoat and bWAPP on OWASP broken web app (in a virtual environment)
* creds for WebGoat: uname and passwd are _guest_

* XSS is the process of injecting a script into one or more parameters of a URL
    * the intention is to attack the client and/or server side of the site/app
* three types of XSS
    1. reflected. the data fetched by the injected script is _reflected_ (visible) to the user on the screen
        * input is stored in the affected parameter of the URL
        * said parameter can be manipulated to run a script, say, a malicious JS script (see what I did there?)
        * 
    2. stored. the input to be stored in a database is attacked, that is, injecting malicious code that will be stored in a database or saved by the server
        * can be accessed later since it is being stored
        * can be made to perform various malicious tasks e.g. turn on a webcam, log keystrokes, steal info etc
        * best places to inject malicious code is comment sections, post forms etc
    3. DOM. focuses on the client side; any data input/entered is processed by the client, not the server and/or database
        * example: typing the following script into the input field does not show anything to the user because the _client_, not the _server_ processes it

        ~~~javascript
        <script>alert("Hello, world. This is an example of DOM XSS")</script>
        ~~~

        * what happens when scripts written in a client-friendly language are ran?
            * very good question; observe
            
            ~~~html
            <img src="" onerror="alert('Hello, world. This is an example of DOM XSS')"/>
            ~~~

            * an alert modal appears; it contains the text _Hello, world. This is an example of DOM XSS_

### how to perform reflected XSS
* fire up `bWAPP`
* set the security level to `low`
* set the bug to `Cross-Site Scripting - Reflected (GET)`
* click `Hack`
    * a login screen shows up
    * click `Go` (uname and passwd are blank); notice what happens in the address bar
    * the URL now has parameters `firstname`, `lastname` and `form` viz

    ~~~text
    <machineIP>/bWAPP/xss.get.php?firstname=&lastname=&form=submit
    ~~~

    * these params can be edited directly on the address bar because security level is set to low
    * most sites in the real world have validation rules and/or filtering processes to deal with such attacks
* in the `First name:` input field, type in the following

~~~javascript
<script>alert("Hello, world. This is an example of reflected XSS")
~~~

* in the `Last name:` input field, type in the following

~~~javascript
</script>
~~~

* click `Go`
    * an alert modal appears; it contains the text _Hello, world. This is an example of reflected XSS_

### how to perform stored XSS
* fire up `bWAPP`
* set the security level to `low`
* set the bug to `Cross-Site Scripting - Stored (Blog)`
* click `Hack`
    * a submit form and blank table show up
    * type `Hello, world` in the input field and click `Submit`
    * the input is stored in the table
    * most sites in the real world have validation rules and/or filtering processes to deal with such attacks
    * scripts can be ran here since security is set to low
* in the input field, type the following

~~~javascript
<script>alert("Hello, world. This is an example of stored XSS")</script>
~~~

* click `Submit`
    * an alert modal appears; it contains the text _Hello, world. This is an example of stored XSS_

### how to perform stored XSS
* fire up `WebGoat`. use _guest_ as uname and password
* on the left click `AJAX Security`
* under _AJAX Security_, click `LAB: DOM-Basex cross-site scripting`
* in the input field, type the following and click `Submit Solution`

~~~javascript
<script>alert("Hello, world. This is an example of DOM XSS")</script>
~~~

* notice how nothing happens, or appears to happen, because the _client_, not the _server_ processes it
* type in the following in the input field and click `Submit Solution`

~~~html
<img src="" onerror="alert('Hello, world. This is an example of DOM XSS')"/>
~~~

* now, an alert modal appears; it contains the text _Hello, world. This is an example of DOM XSS_
    * why?
    * the script is  written in a client-friendly language (in this case, HTML); the first script is in JS
