# broken object property-level authorisation (BOPLA)

#### API specific
#### Business specific
#### Exploitability: easy
#### Prevalence: common
#### Detectability: easy
#### Technical: moderate


### threat agents/attack vectors
* APIs expose endpoints that return all object’s properties; this is particularly valid for REST APIs
* for other protocols such as GraphQL, it may require crafted requests to specify which properties should be returned
* identifying these additional properties that can be manipulated requires more effort but there are a few automated tools available to assist in this task
* excessive data exposure
    * is when an API responds with an entire data object
    * usually, APIs filter data to return what is being requested
    * EDE relies on consumer/UI to filter the exposure risk
* mass assignment
    * allows user input to alter sensitive object properties
    * example:
        * APIs use a special prop to ceate admin accounts
        * only authorised users should be able to make requests
        * if there are no restrictions in place, the attacker can elevate privileges and perform administrative actions

### security weakness
* inspecting API responses is enough to identify sensitive information in returned objects’ representations
* fuzzing is usually used to identify additional (hidden) properties; whether they can be changed is a matter of crafting an API request and analysing the response
* side-effect analysis may be required if the target property is not returned in the API response

### impact
* unauthorised access to private/sensitive object properties may result in data disclosure, data loss or data corruption
* under certain circumstances, unauthorised access to object properties can lead to privilege escalation or partial/full account takeover

### example


### how To prevent
* when exposing an object using an API endpoint, always make sure that the user should have access to the object's properties you expose
* avoid using generic methods such as `to_json()` and `to_string()`. instead, cherry-pick specific object properties you specifically want to return
* if possible, avoid using functions that automatically bind a client's input into code variables, internal objects, or object properties (_mass assignment_).
* allow changes only to the object's properties that should be updated by the client
* implement a schema-based response validation mechanism as an extra layer of security. as part of this mechanism, define and enforce data returned by all API methods
* keep returned data structures to the bare minimum according to the business/functional requirements for the endpoint
