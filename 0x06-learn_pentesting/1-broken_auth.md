# Broken Authentication (BA)

#### API specific
#### Business specific
#### Exploitability: easy
#### Prevalence: common
#### Detectability: easy
#### Technical: severe

### threat agents/attack vectors
* the authentication mechanism is an easy target for attackers since it is exposed to everyone
* exploitation tools are generally available although more advanced technical skills may be required to exploit some authentication issues

### security weakness
* authentication issues are prevalent because of the misconceptions by software and security engineers regarding authentication boundaries and their inherent implementation complexity
* methodologies of detecting broken authentication are available and easy to create

### impact
* attackers may gain complete control of other users’ accounts in the system, read their personal data and perform sensitive actions all while the system thinks it is dealing with the actual user
* systems are unlikely to be able to distinguish attackers’ actions from those of legitimate user

### example


### how To prevent

* know all the possible flows to authenticate to the API (mobile/ web/deep links that implement one-click authentication/etc). ask your engineers what flows you missed
* read about your authentication mechanisms. make sure you understand what and how they are used. OAuth is not authentication neither are API keys
* do not re-invent the wheel in authentication, token generation or password storage. use the standards
* credential recovery/forgot password endpoints should be treated as login endpoints in terms of brute force, rate limiting and lockout protections
* require re-authentication for sensitive operations (e.g. changing the account owner email address/2FA phone number)
* use the OWASP Authentication Cheatsheet
* where possible, implement multi-factor authentication
* implement anti-brute-force mechanisms to mitigate credential stuffing, dictionary attacks and brute force attacks on your authentication endpoints. this mechanism should be stricter than the regular rate-limiting mechanisms on your APIs
* implement account lockout/captcha mechanisms to prevent brute-force attacks against specific users
* implement weak-password checks
* API keys should not be used for user authentication; they should only be used for API clients authentication
