# unrestricted access to sensitive business flows

#### API specific
#### Business specific
#### Exploitability: easy
#### Prevalence: widespread
#### Detectability: easy
#### Technical: moderate


### threat agents/attack vectors
* exploitation, usually, involves understanding the business model backed by the API, finding sensitive business flows and automating access to these flows
* this causes harm to the business
* flow -> a series of requests and responses that lead to an action and/or state

### security weakness
* lack of a holistic view of the API in order to fully support business requirements contributes to the prevalence of this issue
* attackers manually identify what resources (e.g. endpoints) are involved in the target workflow(s) and how they work together
* if mitigation mechanisms are already in place, attackers find a way to bypass them

### impact
* in general, technical impact is not expected; exploitation might hurt the business in different ways, for example:
    * prevent legitimate users from purchasing a product
    * lead to inflation in the internal economy of a game

### example


### how To prevent
* mitigation planning is done in two layers:
    * business -> identify the business flows that might harm the business if they are excessively used
    * engineering -> choose the right protection mechanisms to mitigate the business risk
* some of the protection mechanisms are more simple while others are more difficult to implement. the following methods are used to slow down automated threats:
    * device fingerprinting: denying service to unexpected client devices (e.g headless browsers) tends to make threat actors use more sophisticated solutions thus more costly for them
    * human detection: using either captcha or more advanced biometric solutions (e.g. typing patterns)
    * non-human patterns: analyse the user flow to detect non-human patterns (e.g. the user accessed the "add to cart" and "complete purchase" functions in less than one second)
    * consider blocking IP addresses of `Tor` exit nodes and well-known proxies
* secure and limit access to APIs that are consumed directly by machines (such as developer and B2B APIs). they are an easy target for attackers because they often do not implement all the required protection mechanisms