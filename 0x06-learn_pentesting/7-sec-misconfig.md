# security misconfiguration

#### API specific
#### Business specific
#### Exploitability: easy
#### Prevalence: widespread
#### Detectability: easy
#### Technical: severe


### threat agents/attack vectors
* attackers attempt to find unpatched flaws, common endpoints, services running with insecure default configurations or unprotected files and directories to gain unauthorised access or knowledge of the system
* most of this is public knowledge and exploits may be available
### security weakness
* security misconfiguration happen at any level of the API stack from the network level to the application level
* automated tools are available to detect and exploit misconfigurations such as unnecessary services or legacy options

### impact
* security misconfigurations not only expose sensitive user data but also system details that can lead to full server compromise

### example
*

### how To prevent
* ensure that all API communications from the client to the API server and any downstream/upstream components happen over an encrypted communication channel (TLS) regardless of whether it is an internal or public-facing API
* be specific about which HTTP verbs each API can be accessed by; all other HTTP verbs should be disabled (e.g. HEAD)
* APIs expecting to be accessed from browser-based clients (e.g., web-app front-end) should, at least:
    * implement a proper cross-origin resource sharing (CORS) policy
    * include applicable security headers
* restrict incoming content types/data formats to those that meet the business/ functional requirements
* ensure all servers in the HTTP server chain (e.g. load balancers, reverse and forward proxies and back-end servers) process incoming requests in a uniform manner to avoid de-sync issues
* where applicable, define and enforce all API response payload schemas, including error responses, to prevent exception traces and other valuable information from being sent back to attackers